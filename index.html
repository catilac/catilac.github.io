<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8">
    <title>hi</title>

    <link rel="stylesheet" type="text/css" href="styles.css">
  </head>

  <body>
    <div class='box'>
      <h1>Chirag Dav√©</h1>

      <section class='about-me'>
        <h3>About Me</h3>
        <p>Fullstack web and iOS developer with 11 years of experience üë¥üèΩ</p>
        <p>Getting real into Graphics Programming using Metal ü§òüèΩ</p>
        <p>I'm learning how to water color!üé®</p>
      </section>
      
      <section class='projects'>
        <h3>Projects</h3>
        <ul>
          <li>
            <a href='https://github.com/catilac/psychout'>PsychOut</a>
          </li>
        </ul>
      </section>

      <section class='links'>
        <h3>Links</h3>
        <ul>
          <li>
            <a href='https://github.com/catilac'>Github</a>
          </li>
          <li>
            <a href='https://linkedin.com/in/chiraggdave'>LinkedIn</a>
          </li>
          <li>
            <a href='https://twitter.com/dogforcedog'>Twitter</a>
          </li>
          <li>
            <a href='https://www.instagram.com/dogforcedog/'>Instagram</a>
          </li>
        </ul>
      </section>

    </div>

    <div id='container'></div>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/three.js/108/three.min.js'></script>
    <script id="vertexShader" type="x-shader/x-vertex">
        void main() {
            gl_Position = vec4( position, 1.0 );
        }
    </script>
    <script id="fragmentShader" type="x-shader/x-fragment">
        #ifdef GL_ES
        precision mediump float;
        #endif

        uniform vec2 u_resolution;
        uniform vec2 u_mouse;
        uniform float u_time;

        float EPSILON = 0.001;

        // geometry
        float unionSDF(float d0, float d1) {
          return min(d0, d1);
        }

        float sphereSDF(vec3 p, float r) {
          return length(p) - r;
        }

        float planeSDF(vec3 p, float y) {
          return p.y - y;
        }

        float sceneSDF(vec3 pos) {
          float dsphere = sphereSDF(pos, 0.3);
          float dplane = planeSDF(pos, -1.);
          return unionSDF(dsphere, dplane);
        }

        vec3 estimateNormal(vec3 p) {
          return normalize(vec3(
            sceneSDF(vec3(p.x + EPSILON, p.y, p.z) -
            sceneSDF(vec3(p.x - EPSILON, p.y, p.z))),
            sceneSDF(vec3(p.x, p.y + EPSILON, p.z) -
            sceneSDF(vec3(p.x, p.y - EPSILON, p.z))),
            sceneSDF(vec3(p.x, p.y, p.z + EPSILON) -
            sceneSDF(vec3(p.x, p.y, p.z - EPSILON)))
          ));
        }


        float trace(vec3 rayOrigin, vec3 dir) {
          float totalDist = 0.;

          for (int i = 0; i < 100; i++) {
            float dist = sceneSDF(rayOrigin);
            rayOrigin += dist * dir;
            totalDist += dist;

            if (dist < EPSILON) {
              return totalDist;
            }
          }

          return 0.;
        }
        
        void main() {
            vec2 st = -1. + 2. * gl_FragCoord.xy/u_resolution;

            vec3 cameraOrigin = vec3(0., 0., -5.);
            vec3 rayOrigin = vec3(st.x, st.y, 0);
            vec3 lookAt = normalize(rayOrigin - cameraOrigin);
            
            vec3 color = vec3(trace(cameraOrigin, lookAt));
            vec3 normal = estimateNormal(rayOrigin);
        
            gl_FragColor = vec4(color * normal,1.0);
        }
    </script>
    <script src='app.js'></script>
  </body>

</html>
